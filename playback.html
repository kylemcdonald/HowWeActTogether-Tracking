<html>
<head>
<meta charset="UTF-8">
<title>How We Act Together Playback</title>

<script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/p5.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.4/addons/p5.dom.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/4.16.5/lodash.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clmtrackr/1.0.0/clmtrackr.js"></script>

<!-- 
<script src="libs/p5.min.js"></script>
<script src="libs/p5.dom.min.js"></script>
<script src="libs/lodash.min.js"></script>
<script src="libs/clmtrackr/clmtrackr.js"></script>
 -->

<script src="libs/model_pca_20_svm.js"></script>
<style>*{font-family: sans-serif;}</style>
</head>
<body style="background:gray">
<div id="data-nod-yes"></div>
<div id="data-nod-no"></div>
<div id="data-surprised"></div>
<div id="data-yawn"></div>
<script src="js/utils.js"></script>
<script>
var referenceTracker = createTracker();
var dataAnimation = function(filename) {
	return function(p) {
		var u = new utils(p);
		var w = 640, h = 480;
		var frameNumber = 0;
		var recording = [];

		p.setup = function () {
			p.createCanvas(w, h);
			p.loadJSON(filename, function(data) {
				recording = data;
			});
		}

		p.draw = function () {
			p.clear();
			if(recording.length > 0) {
				var params = recording[frameNumber % recording.length];
				var positions = referenceTracker.calculatePositions(params);
				u.drawFace(positions, u.buildDescription(positions));
				frameNumber++;
			}
		}
	}
}

new p5(dataAnimation('data/nod-yes.json'), 'data-nod-yes');
new p5(dataAnimation('data/nod-no.json'), 'data-nod-no');
new p5(dataAnimation('data/surprised.json'), 'data-surprised');
new p5(dataAnimation('data/yawn.json'), 'data-yawn');
</script>
</body>
</html>